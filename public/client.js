'use strict';function xa(a){for(;a>m;)a-=2*m;for(;a<-m;)a+=2*m;return a}function ya(a,b){for(let c=0;c<a.s.length;c++){let e=a.s[c];if(e.v===b)return e}return null}function za(){var a=r;return ya(a,a.F)}function t(a,b,c){let e=new Float32Array(3);e[0]=a;e[1]=b;e[2]=c;return e}
function Ca(a){var b=w,c=Da,e=x.j;let d=[],f=[];d[0]=a[0]-c[0];d[1]=a[1]-c[1];d[2]=a[2]-c[2];f[0]=d[2]*Math.sin(e)+d[0]*Math.cos(e);f[1]=d[1];f[2]=d[2]*Math.cos(e)-d[0]*Math.sin(e);b[0]=f[0]+c[0];b[1]=f[1]+c[1];b[2]=f[2]+c[2]};function Ea(){var a=new Float32Array(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}function Fa(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1}
function Ga(a,b,c){var e=Math.sin(c);c=Math.cos(c);var d=b[0],f=b[1],k=b[2],g=b[3],h=b[8],l=b[9],p=b[10],v=b[11];b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=d*c-h*e;a[1]=f*c-l*e;a[2]=k*c-p*e;a[3]=g*c-v*e;a[8]=d*e+h*c;a[9]=f*e+l*c;a[10]=k*e+p*c;a[11]=g*e+v*c};function Ha(a){this.usage=a;this.B=new Float32Array(65536);this.g=new Float32Array(65536);this.i=new Uint16Array(65536);Ia(this)}function Ia(a){a.K=0;a.S=0;a.h=0;a.j=0}
function Ja(a,b,c,e,d,f){const k=a.K;for(var g=0;4>g;g++){for(var h=0;3>h;h++)a.B[a.S++]=b[g][h];a.K++}g=d||16;b=c/128;d=e/128;c=(c+g)/128;e=(e+(f||g))/128;a.g[a.h++]=b;a.g[a.h++]=d;a.g[a.h++]=c;a.g[a.h++]=d;a.g[a.h++]=c;a.g[a.h++]=e;a.g[a.h++]=b;a.g[a.h++]=e;a.i[a.j++]=k;a.i[a.j++]=k+1;a.i[a.j++]=k+2;a.i[a.j++]=k;a.i[a.j++]=k+2;a.i[a.j++]=k+3}function Ka(a){var b=y;a.m=b.createBuffer();a.I=b.createBuffer();a.l=b.createBuffer();La(a,b)}
function La(a,b){b.bindBuffer(34962,a.m);b.bufferData(34962,a.B,a.usage);b.bindBuffer(34962,a.I);b.bufferData(34962,a.g,a.usage);b.bindBuffer(34963,a.l);b.bufferData(34963,a.i,a.usage)}
function Ma(a){var b=y,c=Na,e=Oa;b.bindBuffer(34962,a.m);b.vertexAttribPointer(c.G.M,3,5126,!1,0,0);b.enableVertexAttribArray(c.G.M);b.bindBuffer(34962,a.I);b.vertexAttribPointer(c.G.J,2,5126,!1,0,0);b.enableVertexAttribArray(c.G.J);b.bindBuffer(34963,a.l);b.useProgram(c.P);b.uniformMatrix4fv(c.L.R,!1,Pa);b.uniformMatrix4fv(c.L.O,!1,ib);b.activeTexture(33984);b.bindTexture(3553,e);b.drawElements(4,a.j,5123,0)}
window.addEventListener("message",a=>{"moveLeftDown"===a.data.action&&A(65,!0);"moveLeftUp"===a.data.action&&A(65,!1);"moveRightDown"===a.data.action&&A(68,!0);"moveRightUp"===a.data.action&&A(68,!1);"moveUpDown"===a.data.action&&A(87,!0);"moveUpUp"===a.data.action&&A(87,!1);"moveDownDown"===a.data.action&&A(83,!0);"moveDownUp"===a.data.action&&A(83,!1);"jumpDown"===a.data.action&&A(32,!0);"jumpUp"===a.data.action&&A(32,!1);if("fireStart"===a.data.action){var b=new KeyboardEvent("keydown",{key:"f",
keyCode:70,which:70,bubbles:!0});window.dispatchEvent(b)}"fireStop"===a.data.action&&(b=new KeyboardEvent("keyup",{key:"f",keyCode:70,which:70,bubbles:!0}),window.dispatchEvent(b));"pointerLockChange"===a.data.action&&(a=new PointerEvent("pointerlockchange",{bubbles:!0}),window.dispatchEvent(a))});function jb(){this.g=!1;this.h=0}const C=Array(256);for(let a=0;256>a;a++)C[a]=new jb;document.addEventListener("keydown",function(a){console.log("keydown",a.keyCode);A(a.keyCode,!0)});document.addEventListener("keyup",function(a){A(a.keyCode,!1)});function A(a,b){0<=a&&256>a&&(C[a].g=b)};function kb(a,b,c){b=a.createShader(b);a.shaderSource(b,c);a.compileShader(b);return b};const D=new AudioContext,lb=D.sampleRate,mb=D.createBuffer(1,lb,lb),nb=mb.getChannelData(0);for(let a=0;a<lb;a++)nb[a]=2*Math.random()-1;
function ob(a,b){if(!(500<a)){var c=b||1;b=1-a/500;var e=b*b,d=1E3-a;b=5E3-10*a;a=Math.max(1,10-a/50);var f=D.currentTime,k=D.createGain();k.gain.value=0;k.gain.setValueAtTime(10*e,f);k.gain.exponentialRampToValueAtTime(.001,f+.7*c);k.gain.setValueAtTime(0,f+c);k.connect(D.destination);c=D.createBiquadFilter();c.type="lowpass";c.Q.value=1;c.frequency.value=d;c.connect(k);d=D.createBiquadFilter();d.type="lowshelf";d.frequency.value=b;d.gain.value=a;d.connect(c);b=D.createBufferSource();b.buffer=mb;
b.connect(d);b.start()}}let pb=0,qb=0;const rb=D.createGain();rb.connect(D.destination);rb.gain.setTargetAtTime(.04,0,.01);function sb(a){rb.gain.setValueAtTime(a?.1:0,D.currentTime)}function tb(a,b){let c=D.createOscillator();c.connect(rb);c.type="sawtooth";c.frequency.setTargetAtTime(a,pb,.01);c.start(pb);c.stop(pb+.99*b)}
setInterval(function(){for(;pb<D.currentTime+.1;){let a=(qb/8|0)%4,b=qb%8;0===b||3===b?tb(73,.5):tb(73,.25);0===b&&(1===a?tb(349,2):2===a?tb(392,2):3===a&&tb(415,2));pb+=.25;qb++}},100);let ub=null,vb=document.createElement("canvas");vb.width=1024;vb.height=1024;let I=vb.getContext("2d");
function wb(a,b,c,e){J.fillStyle="#323e30";J.fillRect(a,b,c,c);if(ub){I.drawImage(ub,0,0,1024,1024,0,0,1024,1024);const g=(x.x- -500)/1E3*1024,h=(500-x.z)/1E3*1024;var d=r.currentTime;if(0<d){var f=va(K,d),k=f.g/1E3*1024;I.fillStyle=xb(.66,1,1,.5);I.beginPath();I.arc((f.x- -500)/1E3*1024,(500-f.z)/1E3*1024,k,0,2*m);I.rect(1024,0,-1024,1024);I.fill();d=ua(K,d);f=d.g/1E3*1024;k=(d.x- -500)/1E3*1024;let l=(500-d.z)/1E3*1024;I.strokeStyle="#fff";I.beginPath();I.arc(k,l,f,0,2*m);I.rect(1024,0,-1024,1024);
I.lineWidth=2;I.stroke();ra(d,x)&&(I.lineWidth=1,I.strokeStyle="#fff",I.beginPath(),I.moveTo(g,h),I.lineTo(k,l),I.stroke())}I.beginPath();I.moveTo(g,h);I.arc(g,h,60,x.j-.16*m-.5*m,x.j+.16*m-.5*m);I.fillStyle=xb(0,0,1,.5);I.fill();I.beginPath();I.arc(g,h,5,0,2*m);I.fillStyle="red";I.fill();I.lineWidth=2;I.strokeStyle="#fff";I.stroke();e?J.drawImage(vb,0,0,1024,1024,a,b,c,c):J.drawImage(vb,g-c/2,h-c/2,c,c,a,b,c,c)}J.strokeStyle="#fff";J.lineWidth=2;J.beginPath();J.rect(a,b,c,c);J.stroke()};const yb={0:"N",45:"NE",90:"E",135:"SE",180:"S",225:"SW",270:"W",315:"NW"};function Cb(){Q("center");var a=J.createLinearGradient(R,S-100,R,S-50);a.addColorStop(0,"#fffe37");a.addColorStop(1,"#fe9400");J.fillStyle=a;J.fillRect(R-100,S-100,200,50);J.fillStyle="#000";J.font="bold 40px arial";J.fillText("ZingForce",R,S-60);a=J.createLinearGradient(R,S-50,R,S+50);a.addColorStop(0,"#fffe37");a.addColorStop(1,"#fe9400");J.fillStyle=a;J.font="bold 50px arial";J.fillText("BATTLEGROUNDS",R,S)}
function Db(a){return Eb>R-50&&Eb<R+50&&Fb>S+a&&Fb<S+a+40}function Gb(a,b){J.fillStyle=Db(b)?"#fffe37":"#fe9400";J.fillRect(R-50,S+b,100,40);T(a,R,S+b+27)}function Hb(a){J.fillStyle=xb(0,0,0,.5);J.fillRect(0,0,U,V);Q("left");W(40);T(a,50,100);(a=za())&&T("Rank #"+(a.H||1),50,150)}function T(a,b,c){J.fillStyle="#000";J.fillText(a,b+1,c+1);J.fillStyle="#fff";J.fillText(a,b,c)}
function Ib(a,b,c,e){J.strokeStyle="#000";J.beginPath();J.moveTo(a,b);J.lineTo(c,e);J.stroke();J.strokeStyle="#fff";J.beginPath();J.moveTo(a,b);J.lineTo(c,e);J.stroke()}function W(a){J.font=a+"px sans-serif"}function Q(a){J.textAlign=a}
function xb(a,b,c,e){var d=6*a|0;var f=6*a-d;a=c*(1-b);var k=c*(1-f*b);b=c*(1-(1-f)*b);switch(d%6){case 0:var g=c;var h=b;var l=a;break;case 1:g=k;h=c;l=a;break;case 2:g=a;h=c;l=b;break;case 3:g=a;h=k;l=c;break;case 4:g=b;h=a;l=c;break;case 5:g=c,h=a,l=k}return"rgba("+(255*g|0)+","+(255*h|0)+","+(255*l|0)+","+(e||1)+")"};const Jb=io({upgrade:!1,transports:["websocket"]});let Kb=0,Lb=0,Mb=0;
Jb.on("update",function(a){var b=null===r||r.g!==a.g;r=a;if(b){K=new sa(r.i);b=y;var c=kb(b,b.VERTEX_SHADER,"\nattribute vec4 a;\nattribute vec2 b;\nuniform mat4 c;\nuniform mat4 d;\nvarying highp vec2 e;\nvoid main(void){\ngl_Position=d*c*a;\ne=b;\n}");var e=kb(b,b.FRAGMENT_SHADER,"\nvarying highp vec2 e;\nuniform sampler2D f;\nvoid main(void){\ngl_FragColor=texture2D(f,e);\nif(gl_FragColor.a<0.1)discard;\n}"),d=b.createProgram();b.attachShader(d,c);b.attachShader(d,e);b.linkProgram(d);c=d;Na={P:c,
G:{M:b.getAttribLocation(c,"a"),J:b.getAttribLocation(c,"b")},L:{O:b.getUniformLocation(c,"c"),R:b.getUniformLocation(c,"d")}};Nb=new Ha(35044);Ob=new Ha(35048);for(b=0;64>b;b++){e=b/64*m*2;d=(b+1)/64*m*2;c=1E3*Math.cos(e);e=1E3*Math.sin(e);var f=1E3*Math.cos(d),k=1E3*Math.sin(d);d=t(c,1E3,e);var g=t(f,1E3,k);f=t(f,0,k);c=t(c,0,e);Ja(Nb,[d,g,f,c],64,0)}b=t(-1E3,1E3,-1E3);c=t(1E3,1E3,-1E3);e=t(1E3,1E3,1E3);d=t(-1E3,1E3,1E3);Ja(Nb,[b,c,e,d],64,0,1);b=t(-1E3,0,-1E3);c=t(1E3,0,-1E3);e=t(1E3,0,1E3);d=
t(-1E3,0,1E3);Ja(Nb,[b,c,e,d],96,0);for(b=-400;400>b;b+=40)for(c=-400;400>c;c+=40)e=t(b,n(K,b,c),c),d=t(b+40,n(K,b+40,c),c),g=t(b+40,n(K,b+40,c+40),c+40),f=t(b,n(K,b,c+40),c+40),Ja(Nb,[e,d,g,f],80,0);for(b=0;b<K.i.length;b++)Pb(K.i[b].x,K.i[b].z,5,0,32);for(b=0;b<K.l.length;b++)Pb(K.l[b].x,K.l[b].z,1,32,16);Ka(Nb);Ka(Ob);ub=document.createElement("canvas");ub.width=1024;ub.height=1024;b=ub.getContext("2d");b.fillStyle="#163849";b.fillRect(0,0,1024,1024);c=1E4;e=0;for(d=-400;400>d;d+=40)for(g=-400;400>
g;g+=40)f=n(K,g,d),0<f&&(c=Math.min(c,f),e=Math.max(e,f));for(d=-400;400>d;d+=40)for(g=-400;400>g;g+=40){f=(n(K,g,d)+n(K,g+40,d)+n(K,g+40,d+40)+n(K,g,d+40))/4;if(0>=f)continue;k=(g- -500)/1E3*1024;const h=(500-d)/1E3*1024,l=(g+40- -500)/1E3*1024,p=(500-(d+40))/1E3*1024;b.fillStyle=xb(110/360,.4,Math.min(1,.4+.7*(f-c)/(e-c)));b.beginPath();b.rect(k,h,l-k,p-h);b.fill()}sb(0===r.g)}if(b=a.D){for(c=0;c<b.length;c++)switch(d=b[c],d.A){case 13:d.u=8;Qb.push(d);d.l!==a.F&&ob(Math.hypot(d.x-x.x,d.z-x.z));
break;case 14:d.u=16;Qb.push(d);break;case 15:e=ya(r,d.v);(d=ya(r,d.l))?Rb.push(d.name+" killed "+e.name):Rb.push(e.name+" died outside the circle");break;case 16:d.l===a.F&&ob(0,.2)}b.length=0}a=Date.now();0<Kb&&(Lb=a-Kb,Mb=0<Mb?.1*Lb+.9*Mb:Lb);Kb=a;Jb.emit("update",x);x.actions=[]});const x=new ea(2,0,200,0,0,0,0);var Sb;{let a=localStorage.getItem("n");a||(a=da(),localStorage.setItem("n",a));Sb=a}x.name=Sb;x.m=.1;x.j=.1;x.actions=[];const Qb=[],Rb=[];let Na=null,Nb=null,Ob=null,Tb=!1,Ub=!1,U=2,V=2,R=1,S=1,Eb=0,Fb=0,r=null,K=null;const Vb=document.querySelectorAll("canvas"),Wb=Vb[0],X=Vb[1],J=X.getContext("2d");let Xb=!1,Yb=0;window.addEventListener("resize",Zb,!1);Zb();
X.addEventListener("click",function(a){if(0===a.button&&r)if(0===r.g){if(Db(40)&&($b(8),ob(0,.2)),Db(100)){sb(!1);if(a=prompt("Enter your name",x.name))localStorage.setItem("n",a),x.name=a;sb(!0)}}else Ub||(Tb?0<=r.currentTime&&ac():X.requestPointerLock())});Jb.on("update",a=>{r=a});function ac(){$b(9);console.log("shoot");ob(0);x.m-=.02*Math.random();x.j+=.02*Math.random()-.01}
function $b(a){{var b=w,c=bc,e=Da,d=x.m;let f=[],k=[];f[0]=c[0]-e[0];f[1]=c[1]-e[1];f[2]=c[2]-e[2];k[0]=f[0];k[1]=f[1]*Math.cos(d)-f[2]*Math.sin(d);k[2]=f[1]*Math.sin(d)+f[2]*Math.cos(d);b[0]=k[0]+e[0];b[1]=k[1]+e[1];b[2]=k[2]+e[2]}Ca(w);x.actions.push(new ea(a,x.x,x.y,x.z,w[0],w[1],w[2]))}X.addEventListener("mousedown",function(a){2===a.button&&(Xb=!0)});X.addEventListener("mouseup",function(a){2===a.button&&(Xb=!1)});X.addEventListener("mousemove",function(a){Eb=a.pageX;Fb=a.pageY});
document.addEventListener("pointerlockchange",cc);window.addEventListener("keydown",function(a){"f"!==a.key&&"F"!==a.key||ac()});
function dc(a){a*=.001;const b=a-Yb;Yb=a;if(K){for(let q=0;256>q;q++)C[q].g?C[q].h++:C[q].h=0;Ca(bc);x.h=0;x.i=0;if(C[38].g||C[87].g||C[90].g)x.h=8*w[0],x.i=8*w[2],x.g-=.02;if(C[40].g||C[83].g)x.h=-8*w[0],x.i=-8*w[2],x.g-=.02;if(C[37].g||C[65].g||C[81].g)x.h=-8*w[2],x.i=8*w[0],x.g-=.02;if(C[39].g||C[68].g)x.h=8*w[2],x.i=-8*w[0],x.g-=.02;if(1===C[77].h||Ub&&1===C[27].h)Ub=Ub?!1:!0;x.x+=b*x.h;x.z+=b*x.i;x.g-=20*b;x.y+=b*x.g;var c=n(K,x.x,x.z);x.y<c+1&&(x.g=0,x.y=c+1,1===C[32].h&&(x.g=6))}if(r&&0!==
r.g){Ia(Ob);r.s&&ec(r.s);ec(Qb);if(0<=r.currentTime){{let q=r.currentTime,B=va(K,q);for(let Z=0;64>Z;Z++){const la=Z/64*m*2,Y=(Z+1)/64*m*2,Aa=B.x+B.g*Math.cos(la),ca=B.z+B.g*Math.sin(la),lc=B.x+B.g*Math.cos(Y),mc=B.z+B.g*Math.sin(Y),Tc=t(Aa,400,ca),Uc=t(lc,400,mc),Vc=t(lc,0,mc),Wc=t(Aa,0,ca);Ja(Ob,[Tc,Uc,Vc,Wc],((5*q|0)+Z)%4*32,64,32,64)}}}La(Ob,y);var e=y;e.clearColor(0,0,0,1);e.clearDepth(1);e.enable(2929);e.depthFunc(515);e.enable(3042);e.blendFunc(770,771);e.clear(16640);y.viewport(0,0,U,V);var d=
Pa,f=1/Math.tan((Xb?10:60)*m/180/2),k=1/-3999.9;d[0]=f/(U/V);d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=f;d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=4000.1*k;d[11]=-1;d[12]=0;d[13]=0;d[14]=800*k;d[15]=0;Fa(fc);var g=fc,h=fc,l=x.m,p=Math.sin(l),v=Math.cos(l),aa=h[4],ma=h[5],na=h[6],nc=h[7],oc=h[8],pc=h[9],qc=h[10],rc=h[11];h!==g&&(g[0]=h[0],g[1]=h[1],g[2]=h[2],g[3]=h[3],g[12]=h[12],g[13]=h[13],g[14]=h[14],g[15]=h[15]);g[4]=aa*v+oc*p;g[5]=ma*v+pc*p;g[6]=na*v+qc*p;g[7]=nc*v+rc*p;g[8]=oc*v-aa*p;g[9]=pc*v-ma*p;g[10]=qc*
v-na*p;g[11]=rc*v-nc*p;Fa(gc);Ga(gc,gc,x.j);var L=ib,M=fc,N=gc,Qa=M[0],Ra=M[1],Sa=M[2],Ta=M[3],Ua=M[4],Va=M[5],Wa=M[6],Xa=M[7],Ya=M[8],Za=M[9],$a=M[10],ab=M[11],bb=M[12],cb=M[13],db=M[14],eb=M[15],E=N[0],F=N[1],G=N[2],H=N[3];L[0]=E*Qa+F*Ua+G*Ya+H*bb;L[1]=E*Ra+F*Va+G*Za+H*cb;L[2]=E*Sa+F*Wa+G*$a+H*db;L[3]=E*Ta+F*Xa+G*ab+H*eb;E=N[4];F=N[5];G=N[6];H=N[7];L[4]=E*Qa+F*Ua+G*Ya+H*bb;L[5]=E*Ra+F*Va+G*Za+H*cb;L[6]=E*Sa+F*Wa+G*$a+H*db;L[7]=E*Ta+F*Xa+G*ab+H*eb;E=N[8];F=N[9];G=N[10];H=N[11];L[8]=E*Qa+F*Ua+G*Ya+
H*bb;L[9]=E*Ra+F*Va+G*Za+H*cb;L[10]=E*Sa+F*Wa+G*$a+H*db;L[11]=E*Ta+F*Xa+G*ab+H*eb;E=N[12];F=N[13];G=N[14];H=N[15];L[12]=E*Qa+F*Ua+G*Ya+H*bb;L[13]=E*Ra+F*Va+G*Za+H*cb;L[14]=E*Sa+F*Wa+G*$a+H*db;L[15]=E*Ta+F*Xa+G*ab+H*eb;Ga(ib,ib,m);var O=ib,P=ib,zb=hc,fb=zb[0],gb=zb[1],hb=zb[2];O[0]=P[0]*fb;O[1]=P[1]*fb;O[2]=P[2]*fb;O[3]=P[3]*fb;O[4]=P[4]*gb;O[5]=P[5]*gb;O[6]=P[6]*gb;O[7]=P[7]*gb;O[8]=P[8]*hb;O[9]=P[9]*hb;O[10]=P[10]*hb;O[11]=P[11]*hb;O[12]=P[12];O[13]=P[13];O[14]=P[14];O[15]=P[15];ic[0]=-x.x;ic[1]=
-x.y-.5;ic[2]=-x.z;var z=ib,u=ib,Ab=ic,ha=Ab[0],ia=Ab[1],ja=Ab[2];if(u===z)z[12]=u[0]*ha+u[4]*ia+u[8]*ja+u[12],z[13]=u[1]*ha+u[5]*ia+u[9]*ja+u[13],z[14]=u[2]*ha+u[6]*ia+u[10]*ja+u[14],z[15]=u[3]*ha+u[7]*ia+u[11]*ja+u[15];else{var sc=u[0];var tc=u[1];var uc=u[2];var vc=u[3];var wc=u[4];var xc=u[5];var yc=u[6];var zc=u[7];var Ac=u[8];var Bc=u[9];var Cc=u[10];var Dc=u[11];z[0]=sc;z[1]=tc;z[2]=uc;z[3]=vc;z[4]=wc;z[5]=xc;z[6]=yc;z[7]=zc;z[8]=Ac;z[9]=Bc;z[10]=Cc;z[11]=Dc;z[12]=sc*ha+wc*ia+Ac*ja+u[12];z[13]=
tc*ha+xc*ia+Bc*ja+u[13];z[14]=uc*ha+yc*ia+Cc*ja+u[14];z[15]=vc*ha+zc*ia+Dc*ja+u[15]}Ma(Nb);Ma(Ob)}J.clearRect(0,0,X.width,X.height);if(r)if(0===r.g)Cb(),W(20),Q("center"),Gb("JOIN",40),Gb("NAME",100);else{{let q=za();var Yc=q&&0<q.o}if(Yc)if(1===wa(r))Hb("WINNER WINNER CHICKEN DINNER");else{if(0<=r.currentTime){let q=va(K,r.currentTime),B=za();q&&B&&ra(q,B)&&(J.fillStyle=xb(0,1,1,.5),J.fillRect(0,0,U,V))}if(Ub){const q=.9*V|0;wb(R-q/2|0,S-q/2|0,q,!0)}else{{const q=(180*x.j/m+.5|0)-90,B=U/3,Z=U/3/
180;Q("center");for(let la=0,Y=q,Aa=B;180>=la;la++,Y++,Aa+=Z){const ca=Aa+.5|0;for(var Ba=Y;0>Ba;)Ba+=360;for(;360<=Ba;)Ba-=360;Y=Ba;0===Y%15&&(yb[Y]?(W(14),J.lineWidth=2,Ib(ca,30,ca,40),T(yb[Y],ca,60)):(W(11),J.lineWidth=1,Ib(ca,32,ca,38),T(Y.toString(),ca,60)))}}W(18);J.fillStyle="#000";J.fillRect(U-130,20,40,30);Q("center");var Zc=wa(r),$c=U-110;J.fillStyle="#fff";J.fillText(Zc,$c,42);J.fillStyle="#888";J.fillRect(U-90,20,80,30);Q("left");var ad=U-85;J.fillStyle="#444";J.fillText("ALIVE",ad,42);
{const q=za();q&&(W(24),Q("center"),T("Ammo: "+q.C,R,V-65))}{const q=za();if(q){var Ec=R-200,Fc=V-50,Bb=q.o/100;J.fillStyle=xb(0,1-Bb,.5+.5*Bb);J.fillRect(Ec,Fc,400*Bb,25);J.strokeStyle="#fff";J.lineWidth=1;J.beginPath();J.rect(Ec,Fc,400,25);J.stroke()}}{const q=.15*X.width|0,B=X.width-q-20|0,Z=X.height-q-20|0;wb(B,Z,q,!1);if(r&&0<=r.currentTime){const la=Z-10,Y=30-(r.currentTime|0)%30;W(14);Q("left");T(Y,B,la)}}Q("left");W(11);T("WASD - Move",20,V-140);T("Left click - Shoot",20,V-120);T("Right click - Zoom",
20,V-100);T("M - Map",20,V-80);if(0<=r.currentTime){J.lineWidth=2;Ib(R-30,S,R+30,S);Ib(R,S-30,R,S+30);{let q=(r.currentTime|0)%60,B=.25*V|0;W(40);Q("center");5>q?T("New Play Area marked on map",R,B):20<=q&&25>q?T("Old Play Area goes OFFLINE in 10s!",R,B):30<=q&&35>q&&T("Old Play Area going OFFLINE!",R,B)}}else!r||0<=r.currentTime||(Q("center"),W(14),T("Starts in:",R,S-60),W(60),console.log(-r.currentTime),T(-r.currentTime|0,R,S));W(11);Q("right");for(let q=0;q<Rb.length;q++)T(Rb[q],U-10,80+20*q)}W(11);
Q("center");T("Ping "+Mb.toFixed(0)+" ms",R,V-10)}else Hb("YOU DIED")}else Cb(),W(11),Q("center"),T("Connecting...",R,S+50);requestAnimationFrame(dc)}requestAnimationFrame(dc);function Zb(){U=window.innerWidth;V=window.innerHeight;R=U/2|0;S=V/2|0;Wb&&(Wb.width=U,Wb.height=V);X&&(X.width=U,X.height=V)}function cc(){document.pointerLockElement===X||document.mozPointerLockElement===X?(document.addEventListener("mousemove",jc,!1),Tb=!0):(document.removeEventListener("mousemove",jc,!1),Tb=!1)}
function jc(a){const b=Xb?1E-4:.001;x.j=xa(x.j+b*a.movementX);x.m=xa(x.m+b*a.movementY)};const Da=new Float32Array(3),bc=t(0,0,1),w=new Float32Array(3),ic=new Float32Array(3),hc=t(-1,1,1),Pa=Ea(),ib=Ea(),fc=Ea(),gc=Ea(),y=Wb.getContext("webgl",{alpha:!1,antialias:!1,premultipliedAlpha:!1}),Oa=kc();
function kc(){const a=y.createTexture();y.bindTexture(3553,a);y.texImage2D(3553,0,6408,1,1,0,6408,5121,new Uint8Array([0,0,255,255]));const b=new Image;b.onload=function(){y.bindTexture(3553,a);y.texImage2D(3553,0,6408,6408,5121,b);y.texParameteri(3553,10240,9728);y.texParameteri(3553,10241,9728);y.generateMipmap(3553)};b.src="textures.png";return a}
function Pb(a,b,c,e,d){var f=Nb;const k=n(K,a,b)+c;{var g=t(a-c,k+c,b),h=t(a+c,k+c,b),l=t(a+c,k-c,b);const p=t(a-c,k-c,b);Ja(f,[g,h,l,p],e,0,d)}g=t(a,k+c,b-c);h=t(a,k+c,b+c);l=t(a,k-c,b+c);a=t(a,k-c,b-c);Ja(f,[g,h,l,a],e,0,d)}
function ec(a){for(let k=a.length-1;0<=k;k--){let g=a[k];if(!(0>=g.o||g.v===r.F)){switch(g.A){case 2:{var b=(5*(30+r.currentTime)|0)%4;3===b&&(b=1);var c=.001<Math.hypot(g.h,g.i),e=g.x-x.x;let h=g.z-x.z;var d=Math.hypot(e,h);let l=0;var f=0;0<d&&(e/=d,h/=d,f=Math.sin(g.j),d=Math.cos(g.j),l=e*f+h*d,f=e*d-h*f);e=!1;.7<l?c?(b=48+16*b,c=48):c=b=32:-.7>l?(b=c?48+16*b:0,c=32):(c?(b*=16,c=48):(b=16,c=32),e=0>f);Gc(g,1,b,c,e)}break;case 3:Gc(g,.05,48,0);break;case 13:Gc(g,.04,112,16);g.u-=4;break;case 14:Gc(g,
.5,32+16*Math.min(3,(16-g.u)/4|0),16);g.u--;break;case 6:Gc(g,.5,96,16);break;case 7:Gc(g,.5,112,0)}2!==g.A&&0===g.u&&a.splice(k,1)}}}function Gc(a,b,c,e,d){var f=a.x,k=a.y;a=a.z;var g=f-x.x,h=a-x.z,l=Math.hypot(g,h);g/=l;h/=l;l=d?-1:1;d=f-l*b*h;h=f+l*b*h;f=a+l*b*g;a-=l*b*g;g=k+b;k-=b;b=t(d,g,f);g=t(h,g,a);a=t(h,k,a);k=t(d,k,f);Ja(Ob,[b,g,a,k],c,e)};
